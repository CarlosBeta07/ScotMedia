function doPost(e) {
  try {
    // Leer los datos JSON de la solicitud
    const data = JSON.parse(e.postData.contents); // Parsear el contenido como JSON

    // Obtener la hoja de Google Sheets
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const sheet = ss.getSheetByName("Datos"); // Aseg√∫rate de que el nombre de la hoja sea "Datos"

    // Agregar los datos a la hoja
    sheet.appendRow([
      new Date(), // Fecha de la solicitud
      data.nombre,
      data.telefono,
      data.correo,
      data.sexo,
      data.giro,
      data.fecha,
      data.hora,
      data.comentarios
    ]);

    // Devolver una respuesta exitosa
    return ContentService.createTextOutput(
      JSON.stringify({ result: "success", data: data })
    ).setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    // Manejo de errores
    return ContentService.createTextOutput(
      JSON.stringify({ result: "error", message: error.message })
    ).setMimeType(ContentService.MimeType.JSON);
  }
}
